@namespace scrweb_blazor.Components.Pages.Tablas.AeropuertosPage

@page "/tablas/aeropuertos"
@rendermode InteractiveServer
@layout Components.Layout.TablasLayout

@inject IConfiguration Configuration
@inject IDbContextFactory<dbContext> DbFactory

@using Microsoft.AspNetCore.Authorization
@using Microsoft.EntityFrameworkCore
@using scrweb_blazor.Models.EF_Core
@using scrweb_blazor.Models.General
@using scrweb_blazor.Components.Pages.GeneralPages

@using MudBlazor

@attribute [Authorize(Roles = "admin, user")]

@if (_ciudades is null || _aeropuertos is null)
{
    <LoadingPageComponent />

    @if (_alertSettings.Show)
    {
        <MudAlert Severity="@_alertSettings.Tipo" ShowCloseIcon="true" CloseIconClicked="CloseAlert">@((MarkupString)_alertSettings.Text)</MudAlert>
    }
} else
{
    <MudGrid>
        <MudItem xs="12" sm="12">
            <h3><em><u><span style="white-space: nowrap;">Aeropuertos</span></u></em></h3>
        </MudItem>

        <MudItem xs="12" sm="12">
            @if (_alertSettings.Show)
            {
                <MudAlert Severity="@_alertSettings.Tipo" ShowCloseIcon="true" CloseIconClicked="CloseAlert">@((MarkupString)_alertSettings.Text)</MudAlert>
            }
        </MudItem>

        <MudItem xs="12" sm="12">

            <MudDataGrid T="Aeropuerto_dto"
                         Items="@_aeropuertos"
                         Virtualize="true"
                         FixedHeader="true"
                         Height="350px"
                         Hover="true"
                         Dense="true"
                         Striped="true"
                         Bordered="true"
                         ReadOnly="false" 
                         EditMode="DataGridEditMode.Cell"
                         Filterable="false">

                <Columns>

                    <PropertyColumn Property="x => x.Id" 
                                    HeaderStyle="font-weight: bold; text-align: center; width: 65px; "
                                    CellStyle="text-align: center; "
                                    Sortable="false"
                                    Editable="false" 
                                    Filterable="false" />

                    <PropertyColumn Property="x => x.Nombre" 
                                    HeaderStyle="font-weight: bold; " 
                                    Filterable="false" />

                    <PropertyColumn Property="x => x.Abreviatura" 
                                    HeaderStyle="font-weight: bold; " 
                                    Filterable="false" />

                    <TemplateColumn HeaderStyle="font-weight: bold; " Title="Ciudad">
                        <EditTemplate>
                            <MudSelect @bind-Value="context.Item.CiudadId"
                                       Dense="true"
                                       Margin="@Margin.Dense">
                                    @foreach (var ciudad in _ciudades)
                                    {
                                        <MudSelectItem Value="@ciudad.Id">@ciudad.Nombre</MudSelectItem>
                                    }
                            </MudSelect>
                        </EditTemplate>
                    </TemplateColumn>

                </Columns>
            </MudDataGrid>
        </MudItem>

    </MudGrid>
}

@code { 
}

<MudBlazor.MudThemeProvider />
<MudBlazor.MudPopoverProvider />
<MudBlazor.MudDialogProvider />
<MudBlazor.MudSnackbarProvider />